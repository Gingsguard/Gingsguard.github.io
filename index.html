<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>熊本熊本熊's Studio.</title><meta name="author" content="熊本熊本熊"><meta name="copyright" content="熊本熊本熊"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta property="og:type" content="website">
<meta property="og:title" content="熊本熊本熊&#39;s Studio.">
<meta property="og:url" content="http://www.kumamon.fun/index.html">
<meta property="og:site_name" content="熊本熊本熊&#39;s Studio.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/avatar.jpg">
<meta property="article:author" content="熊本熊本熊">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/avatar.jpg"><link rel="shortcut icon" href="/img/avatar.ico"><link rel="canonical" href="http://www.kumamon.fun/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="TVyzKx63HHaz5wS0"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177549855-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177549855-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2020-09-16 15:37:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">71</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/scaled.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">熊本熊本熊's Studio.</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">熊本熊本熊's Studio.</h1><div id="site_subtitle"><span id="subtitle"></span></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/fastjsonsecurity1/" title="Fastjson历史漏洞研究(一)">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/aed42176e4452c3808195c113a45ca8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Fastjson历史漏洞研究(一)"></a></div><div class="recent-post-info"><a class="article-title" href="/fastjsonsecurity1/" title="Fastjson历史漏洞研究(一)">Fastjson历史漏洞研究(一)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-15T09:46:54.000Z" title="发表于 2020-09-15 17:46:54">2020-09-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">本文衔接上一篇文章《Fastjson 1.2.24反序列化漏洞深度分析》，继续探讨一下FastJson的历史漏洞。
在《Fastjson 1.2.24反序列化漏洞深度分析》一文中，我们以Fastjson 1.2.24反序列化漏洞为基础，详细分析fastjson漏洞的一些细节问题。
Fastjson 1.2.24 版本的远程代码执行漏洞可谓是开辟了近几年来Fastjson漏洞的纪元。在Fastjson 1.2.24版本反序列化漏洞初次披露之后，官方针对这个漏洞进行了修补。然而这个修复方案很快就被发现存在绕过的风险。由于官方的修复方案或多或少都存在着一些问题，随之而来的是一次又一次的绕过与修复。
回顾一下Fastjson反序列化漏洞，简单来说就是：fastjson通过parse、parseObject处理以json结构传入的类的字符串形时，会默认调用该类的共有setter与构造函数，并在合适的触发条件下调用该类的getter方法。当传入的类中setter、getter方法中存在利用点时，攻击者就可以通过传入可控的类的成员变量进行攻击利用。com.sun.rowset.JdbcRowSetI ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/ATutor-CVE-2019-12169/" title="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/3c091f331fbddfc38c244911d7bde42.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析"></a></div><div class="recent-post-info"><a class="article-title" href="/ATutor-CVE-2019-12169/" title="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析">ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-10T09:21:19.000Z" title="发表于 2020-09-10 17:21:19">2020-09-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">漏洞介绍ATutor是ATutor团队的一套开源的基于Web的学习内容管理系统（LCMS），该系统包括教学内容管理、论坛、聊天室等模块。Atutor与Claroline、 Moddle及Sakai号称为四大开源课程管理系统。
ATutor2.2.4语言导入功能处存在一处安全漏洞(CVE-2019-12169)，攻击者可利用该漏洞进行远程代码执行攻击。
经过分析发现，除了CVE-2019-1216所报道的语言导入功能外，ATutor在其他功能模块中也大量存在着相似的漏洞，本文会在后面针对这一点进行介绍。
漏洞分析据漏洞披露可知，漏洞触发点存在于mods/_core/languages/language_import.php文件中
首先跟入language_import.php文件
12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?php/****************************************************************//* AT ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/FastJson-checkAutoType/" title="FastJson checkAutoType安全机制研究">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/d875a0425cab5a73c296a118f6d220e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FastJson checkAutoType安全机制研究"></a></div><div class="recent-post-info"><a class="article-title" href="/FastJson-checkAutoType/" title="FastJson checkAutoType安全机制研究">FastJson checkAutoType安全机制研究</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-19T09:15:32.000Z" title="发表于 2020-08-19 17:15:32">2020-08-19</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">在FastJson1.2.25以及之后的版本中，fastjson为了防止autoType这一机制带来的安全隐患，增加了一层名为checkAutoType的检测机制。在之后的版本中，随着checkAutoType安全机制被不断绕过，fastjson也进行了一系列例如黑名单防逆向分析、扩展黑名单列表等加固。但是checkAutoType的原理未曾有过大的变化，因此本文将以fastjson 1.2.25版本为例，介绍一下checkAutoType安全机制的原理。
在调试分析fastjson的checkAutoType安全机制之前，发现网上很多fastjson漏洞的分析文章中曾经提到过一个名为autoTypeSupport的开关，且在1.2.25以及之后的版本中默认关闭。在动手调试之前，我曾一度以为autoTypeSupport开关关闭与否直接决定了fastjson是完全摒弃或是使用autotype功能的。但是实际调试中发现，这个开关仅仅是checkAutoType安全机制中的一个选项，这个开关的关闭与否，并不直接作用于fastjson是否使用autoType机制，下文案例中可以看出这个问题。 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/fastjson1-2-24/" title="Fastjson 1.2.24反序列化漏洞深度分析">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/Hippopx(1).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Fastjson 1.2.24反序列化漏洞深度分析"></a></div><div class="recent-post-info"><a class="article-title" href="/fastjson1-2-24/" title="Fastjson 1.2.24反序列化漏洞深度分析">Fastjson 1.2.24反序列化漏洞深度分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-17T03:05:38.000Z" title="发表于 2020-07-17 11:05:38">2020-07-17</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content"> Fastjson 1.2.24反序列化漏洞深度分析前言FastJson是alibaba的一款开源JSON解析库，可用于将Java对象转换为其JSON表示形式，也可以用于将JSON字符串转换为等效的Java对象。近几年来fastjson漏洞层出不穷，本文将会谈谈近几年来fastjson RCE漏洞的源头：17年fastjson爆出的1.2.24反序列化漏洞。以这个漏洞为基础，详细分析fastjson漏洞的一些细节问题。
关于Fastjson 1.2.24反序列化漏洞，自从17年以来已经有很多人分析过了，一些基础内容本文就不再陈述了。此次漏洞简单来说，就是Fastjson通过parseObject/parse将传入的字符串反序列化为Java对象时由于没有进行合理检查而导致的
本文将着重分析一下这个漏洞没有被详细介绍过的细节问题，如下：

parseObject(String text) 、parse (String text)、 parseObject(String text, Class&lt;T&gt; clazz)三个方法从代码层面上来看，究竟有何不同？
使用TemplatesIm ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/Monstra-CMS-RCE/" title="Monstra CMS RCE漏洞分析（CVE-2020-13384）">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/hacker-0509-scaled.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Monstra CMS RCE漏洞分析（CVE-2020-13384）"></a></div><div class="recent-post-info"><a class="article-title" href="/Monstra-CMS-RCE/" title="Monstra CMS RCE漏洞分析（CVE-2020-13384）">Monstra CMS RCE漏洞分析（CVE-2020-13384）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-08T09:25:21.000Z" title="发表于 2020-06-08 17:25:21">2020-06-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">前言MonstraCMS是一套基于PHP与XML的现代化的轻量级内容管理系统，整套系统无需使用数据库，据说是一家乌克兰的公司开发的。

Monstra CMS 3.0.4版本中存在着一处安全漏洞，该漏洞源于程序没有正确验证文件扩展名。攻击者可以上传特殊后缀的文件执行任意PHP代码。但是通过分析后发现，这个漏洞的触发是依靠具体环境而来的，下文会详细介绍。
漏洞分析首先看一下Monstra CMS的功能页面

可以发现有一个文件上传功能。通过阅读后台代码可知，程序是通过黑名单机制限制文件上传的类型：

上图即是程序中用来限制上传的黑名单。程序不允许’html’, ‘htm’, ‘js’, ‘jsb’, ‘mhtml’, ‘mht’, ‘php’, ‘phtml’, ‘php3’, ‘php4’, ‘php5’, ‘phps’,’shtml’, ‘jhtml’, ‘pl’, ‘py’, ‘cgi’, ‘sh’, ‘ksh’, ‘bsh’, ‘c’, ‘htaccess’, ‘htpasswd’,’exe’, ‘scr’, ‘dll’, ‘msi’, ‘vbs’, ‘bat’, ‘com’,  ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/phpBB-CVE-2019-13376/" title="phpBB从session id泄露到CSRF到XSS（CVE-2019-13376）">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/709d31dfe992849687470f94fd37242.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="phpBB从session id泄露到CSRF到XSS（CVE-2019-13376）"></a></div><div class="recent-post-info"><a class="article-title" href="/phpBB-CVE-2019-13376/" title="phpBB从session id泄露到CSRF到XSS（CVE-2019-13376）">phpBB从session id泄露到CSRF到XSS（CVE-2019-13376）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-03T09:24:45.000Z" title="发表于 2020-06-03 17:24:45">2020-06-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">前言phpBB是一个论坛软件，使用PHP语言开发的并开放其源码。是模块化设计，具专业性、安全性高、支持多国语系、支持多种数据库和自定义的版面设计等优越性能，而且功能强大。
自2000年发布以来, phpBB已经成为世界上应用最广泛的开源论坛软件。
phpBB 3.2.7版以及之前版本中存在一处安全问题：当管理员从phpBB后台控制面板切换到前台时，系统会将session id存放于访问的前台功能的URL中使得攻击者可以窃取这个session id。由于phpBB的安全限制，攻击者不可以直接利用这个sid登录后台，但是可以协同phpBB后台编辑bbcode页面存在的CSRF漏洞，在目标服务器上实现存储型XSS。
漏洞分析首先来看一下phpBB的后台，也就是ACP页面

可以发现所有后台功能的url中都会携带着sid（session id）参数：
http://127.0.0.1/phpbb/phpBB/adm/index.php?sid=9c4869b4054e9ff8d4d588c32ffcf7e7&amp;i=1
如果url中sid值错误，即使已经登录后台也无法正常的访问后台页面
p ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/WordPress-Page-Buider/" title="WordPress Page Buider插件 CSRF to XSS漏洞分析">     <img class="post_bg" data-lazy-src="http://blog.nsfocus.net/wp-content/uploads/2020/08/image-237-570x456.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WordPress Page Buider插件 CSRF to XSS漏洞分析"></a></div><div class="recent-post-info"><a class="article-title" href="/WordPress-Page-Buider/" title="WordPress Page Buider插件 CSRF to XSS漏洞分析">WordPress Page Buider插件 CSRF to XSS漏洞分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-01T09:26:05.000Z" title="发表于 2020-06-01 17:26:05">2020-06-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">前言Page Builder by SiteOrigin是一个安装量超过100W的WordPress页面生成器插件，该插件可帮助用户使用基于小工具的页面生成器轻松构建响应式页面内容

近日wordfence安全人员披露了一个Page Builder by SiteOrigin2.10.15及以下版本中发现的严重安全漏洞：CSRF to XSS。攻击者可以通过诱使WordPress站点管理员单击特制链接以触发该漏洞，成功利用该漏洞可以使攻击者创建一个新的管理员帐户并安装后门程序。
漏洞分析Page Builder bySiteOrigin插件内置一款实时编辑器，用户可以在观察实时更改的同时更新内容，这使得页面的编辑和设计或发布过程更加流畅。

本次漏洞就是出现在该插件内置的实时编辑器中。
在编辑文章活页面时点击实时编辑器按钮即可使用此工具

在实时编辑器中可以实时预览编辑文章、添加小工具、修改页面布局等情况

以添加小工具功能为例，我们可以添加一个自定义HTML模块

在这个模块中添加一些内容

完成编辑后，用户的编辑效果可以实时呈现在编辑器浏览页面中

实时编辑器仅提供用户对草稿的编辑 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/WordPress-Ninja-Forms/" title="WordPress Ninja Forms插件 CSRF to XSS漏洞（CVE-2020-12462）分析">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/4a44e04be50baddb294deb2987f7180.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WordPress Ninja Forms插件 CSRF to XSS漏洞（CVE-2020-12462）分析"></a></div><div class="recent-post-info"><a class="article-title" href="/WordPress-Ninja-Forms/" title="WordPress Ninja Forms插件 CSRF to XSS漏洞（CVE-2020-12462）分析">WordPress Ninja Forms插件 CSRF to XSS漏洞（CVE-2020-12462）分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-25T09:26:34.000Z" title="发表于 2020-05-25 17:26:34">2020-05-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">前言Ninja Forms是一款WordPress插件。使用Ninja Forms插件无需编码即可以创建美观、用户友好的WordPress表单。据统计，全球超过 2,000,000 个网站正在使用 Ninja Forms。

Ninja Forms 3.4.24.2之前的所有版本中存在一个严重的CSRF to XSS漏洞。成功利用此漏洞可以使得攻击者将WordPress网站中启用的Ninja Forms表单替换为包含恶意JavaScript的表单。当用户使用这些表单时触发xss漏洞。
漏洞分析根据漏洞披露来看，本次漏洞存在于ninja-forms\lib\NF_Upgrade.php文件 ninja_forms_ajax_import_form函数
在分析漏洞之前，我们先来了解下这个存在漏洞的文件是做什么用的。存在漏洞的文件名为NF_Upgrade.php，从字面意义上来看，是升级的意思，但这个文件的功能并不是如同其命名（Upgrade）那样用来升级ninja-forms插件版本，而是涉及到ninja-forms的一个特殊功能——“降级”Ninja Forms插件中存在着一个名为 “降 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/WordPress-Real-Time/" title="WordPress Real-Time Find and Replace插件CSRF to Stored XSS漏洞分析">     <img class="post_bg" data-lazy-src="http://blog.nsfocus.net/wp-content/uploads/2017/02/如何平衡软件安全领域中的安全开发与安全运营.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WordPress Real-Time Find and Replace插件CSRF to Stored XSS漏洞分析"></a></div><div class="recent-post-info"><a class="article-title" href="/WordPress-Real-Time/" title="WordPress Real-Time Find and Replace插件CSRF to Stored XSS漏洞分析">WordPress Real-Time Find and Replace插件CSRF to Stored XSS漏洞分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-13T09:20:12.000Z" title="发表于 2020-05-13 17:20:12">2020-05-13</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">前言Real-Time Find and Replace是一个可以实时查找和替换WordPress网页数据的插件。据统计，该漏洞已安装在100,000多个站点上。
近日Real-Time Find and Replace 3.9版本被披露存在一处高度严重的安全问题：由于Real-Time Find andReplace的核心功能模块并没有采用随机数来校验请求的合法性，从而导致跨站点请求伪造（CSRF）漏洞的产生。攻击者可以利用此漏洞，使用恶意代码替换目标站点页面上的任何内容。
漏洞分析预备知识这一部分是对本次漏洞分析过程中涉及到的WordPress一些函数与机制的介绍，如果对WordPress很了解可以直接跳过
Real-Time Find and Replace插件是如何注册的首先分析下Real-Time Find and Replace插件是如何注册到wordpress的菜单栏中的，以及WordPress是如何调用该插件
real-time-find-and-replace插件代码很少，只有一个php文件real-time-find-and-replace.php
首先看wp-co ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/Joomla-CVE-2020-11890/" title="Joomla提权漏洞（CVE-2020-11890）">     <img class="post_bg" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/381b525f3bbb2cc965a82b68e958dad.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Joomla提权漏洞（CVE-2020-11890）"></a></div><div class="recent-post-info"><a class="article-title" href="/Joomla-CVE-2020-11890/" title="Joomla提权漏洞（CVE-2020-11890）">Joomla提权漏洞（CVE-2020-11890）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-10T09:27:21.000Z" title="发表于 2020-05-10 17:27:21">2020-05-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="content">漏洞简介近日，joomla官方给出了一个安全公告。从公告可知Joomla! CMS versions 2.5.0 - 3.9.16版本在处理用户组时缺少对根用户组的检查，从而导致了一个提权漏洞的产生(CVE-2020-11890)。
经过我分析之后发现，想要利用这个漏洞，必须先要有一个管理员账号，而这个漏洞的作用仅仅能将管理员提权为超级管理员。
虽然这个漏洞看起来无比鸡肋，但是分析过程却其乐无穷：既了解joomla是如何实现用户组权限划分，又复习了下数据结构。总体上来说漏洞虽小，但分析过程还是很有研究与记录价值的。
漏洞分析本次漏洞可以将joomla系统中的Administrator用户提权为Super Users。在分析漏洞前，我们来看一下Super Users与Administrator有什么区别：
超级管理员 (Super Users)：拥有Joomla的所有权限。并且超级管理员只能由另一个超级管理员来创建。
高级管理员（Administrator）：Administrator没有权限将一个用户升级成超级用户或者编辑一个超级用户、不可以修改Joomla的全局设置，没有权限来改变和 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">熊本熊本熊</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length_num">71</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length_num">8</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length_num">2</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://s2.ax1x.com/2019/09/26/unM7lQ.jpg"><i class="fab fa-weixin"></i><span>Follow Me</span></a></div></div><div class="sticky_layout"><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">关于技术方面内容，欢迎在文章下方评论处交流讨论</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/fastjsonsecurity1/" title="Fastjson历史漏洞研究(一)"><img data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/aed42176e4452c3808195c113a45ca8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Fastjson历史漏洞研究(一)"/></a><div class="content"><a class="title" href="/fastjsonsecurity1/" title="Fastjson历史漏洞研究(一)">Fastjson历史漏洞研究(一)</a><time datetime="2020-09-15T09:46:54.000Z" title="发表于 2020-09-15 17:46:54">2020-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ATutor-CVE-2019-12169/" title="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析"><img data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/3c091f331fbddfc38c244911d7bde42.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析"/></a><div class="content"><a class="title" href="/ATutor-CVE-2019-12169/" title="ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析">ATutor学习内容管理系统任意文件上传漏洞(CVE-2019-12169)分析</a><time datetime="2020-09-10T09:21:19.000Z" title="发表于 2020-09-10 17:21:19">2020-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/FastJson-checkAutoType/" title="FastJson checkAutoType安全机制研究"><img data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/d875a0425cab5a73c296a118f6d220e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FastJson checkAutoType安全机制研究"/></a><div class="content"><a class="title" href="/FastJson-checkAutoType/" title="FastJson checkAutoType安全机制研究">FastJson checkAutoType安全机制研究</a><time datetime="2020-08-19T09:15:32.000Z" title="发表于 2020-08-19 17:15:32">2020-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/fastjson1-2-24/" title="Fastjson 1.2.24反序列化漏洞深度分析"><img data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/Hippopx(1).jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Fastjson 1.2.24反序列化漏洞深度分析"/></a><div class="content"><a class="title" href="/fastjson1-2-24/" title="Fastjson 1.2.24反序列化漏洞深度分析">Fastjson 1.2.24反序列化漏洞深度分析</a><time datetime="2020-07-17T03:05:38.000Z" title="发表于 2020-07-17 11:05:38">2020-07-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Monstra-CMS-RCE/" title="Monstra CMS RCE漏洞分析（CVE-2020-13384）"><img data-lazy-src="https://gingsguard.oss-cn-beijing.aliyuncs.com/blog/hacker-0509-scaled.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Monstra CMS RCE漏洞分析（CVE-2020-13384）"/></a><div class="content"><a class="title" href="/Monstra-CMS-RCE/" title="Monstra CMS RCE漏洞分析（CVE-2020-13384）">Monstra CMS RCE漏洞分析（CVE-2020-13384）</a><time datetime="2020-06-08T09:25:21.000Z" title="发表于 2020-06-08 17:25:21">2020-06-08</time></div></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/"><span class="card-category-list-name">技术</span><span class="card-category-list-count">61</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%97%A5%E5%B8%B8/"><span class="card-category-list-name">日常</span><span class="card-category-list-count">6</span></a></li>
            
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/ctf/" style="font-size: 1.1em; color: #999">ctf</a> <a href="/tags/java/" style="font-size: 1.4em; color: #99a5b6">java</a> <a href="/tags/web%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" style="font-size: 1.5em; color: #99a9bf">web漏洞分析</a> <a href="/tags/windows%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" style="font-size: 1.1em; color: #999">windows漏洞分析</a> <a href="/tags/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/" style="font-size: 1.1em; color: #999">技术分享</a> <a href="/tags/%E6%9D%82%E6%96%87/" style="font-size: 1.3em; color: #99a1ac">杂文</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" style="font-size: 1.1em; color: #999">漏洞分析</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 1.2em; color: #999da3">翻译</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/09/"><span class="card-archive-list-date">九月 2020</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/08/"><span class="card-archive-list-date">八月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/07/"><span class="card-archive-list-date">七月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/04/"><span class="card-archive-list-date">四月 2020</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/03/"><span class="card-archive-list-date">三月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/01/"><span class="card-archive-list-date">一月 2020</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives/">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">71</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">108.9k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2020-09-16T07:37:34.169Z"></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By 熊本熊本熊</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "Love&#44;Vulnerability&amp;Security".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: false,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'L'
  }
}

if (true) {
  if (typeof Typed === 'function') subtitleType()
  else $.getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js', subtitleType)
} else {
  subtitleType()
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>